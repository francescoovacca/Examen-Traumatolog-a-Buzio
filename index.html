<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Examen Traumatolog√≠a</title>
    <style>
        :root {
            --color-primary: #2180A1;
            --color-primary-hover: #1B6D87;
            --color-success: #22C55E;
            --color-error: #EF4444;
            --color-warning: #F59E0B;
            --color-bg: #F5F5F5;
            --color-surface: #FFFFFF;
            --color-text: #1F2937;
            --color-text-secondary: #6B7280;
            --color-border: #E5E7EB;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: var(--color-bg);
            color: var(--color-text);
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-primary-hover) 100%);
            color: white;
            padding: 30px 20px;
            margin-bottom: 30px;
            border-radius: 8px;
            text-align: center;
        }

        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        header p {
            opacity: 0.9;
            font-size: 1.1em;
        }

        .main-menu {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .menu-btn {
            background: var(--color-surface);
            border: 2px solid var(--color-border);
            padding: 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 600;
            transition: all 0.3s ease;
            text-align: center;
        }

        .menu-btn:hover {
            background: var(--color-primary);
            color: white;
            border-color: var(--color-primary);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .hidden {
            display: none !important;
        }

        .quiz-container {
            background: var(--color-surface);
            border-radius: 8px;
            padding: 30px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--color-border);
            border-radius: 4px;
            margin-bottom: 20px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--color-primary), var(--color-success));
            transition: width 0.3s ease;
        }

        .question-number {
            color: var(--color-text-secondary);
            font-size: 0.9em;
            margin-bottom: 15px;
        }

        .question {
            font-size: 1.2em;
            font-weight: 600;
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 20px;
        }

        .option {
            background: var(--color-bg);
            border: 2px solid var(--color-border);
            padding: 15px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
        }

        .option:hover {
            background: var(--color-primary);
            color: white;
            border-color: var(--color-primary);
        }

        .option input {
            margin-right: 12px;
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .option.correct {
            background: rgba(34, 197, 94, 0.1);
            border-color: var(--color-success);
        }

        .option.incorrect {
            background: rgba(239, 68, 68, 0.1);
            border-color: var(--color-error);
        }

        .option.correct-answer {
            background: rgba(34, 197, 94, 0.2);
            border-color: var(--color-success);
            font-weight: 600;
        }

        .buttons {
            display: flex;
            gap: 10px;
            margin-top: 25px;
            flex-wrap: wrap;
        }

        button {
            padding: 12px 24px;
            font-size: 1em;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: var(--color-primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--color-primary-hover);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }

        .btn-secondary {
            background: var(--color-border);
            color: var(--color-text);
        }

        .btn-secondary:hover {
            background: #d1d5db;
        }

        .btn-back {
            background: transparent;
            color: var(--color-primary);
            border: 2px solid var(--color-primary);
            padding: 10px 20px;
        }

        .btn-back:hover {
            background: var(--color-primary);
            color: white;
        }

        .results {
            background: var(--color-surface);
            border-radius: 8px;
            padding: 40px 30px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .score-circle {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--color-primary), var(--color-success));
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5em;
            font-weight: bold;
            margin: 0 auto 20px;
        }

        .results h2 {
            font-size: 1.8em;
            margin-bottom: 15px;
        }

        .results p {
            font-size: 1.1em;
            color: var(--color-text-secondary);
            margin-bottom: 10px;
        }

        .detailed-results {
            background: var(--color-bg);
            padding: 20px;
            border-radius: 6px;
            margin-top: 25px;
            text-align: left;
        }

        .result-item {
            margin-bottom: 20px;
            padding: 15px;
            background: white;
            border-left: 4px solid var(--color-border);
            border-radius: 4px;
        }

        .result-item.correct {
            border-left-color: var(--color-success);
        }

        .result-item.incorrect {
            border-left-color: var(--color-error);
        }

        .result-question {
            font-weight: 600;
            margin-bottom: 10px;
            font-size: 1em;
        }

        .result-answer {
            font-size: 0.95em;
            color: var(--color-text-secondary);
            margin: 8px 0;
        }

        .case-scenario {
            background: #F0F9FF;
            padding: 20px;
            border-left: 4px solid var(--color-primary);
            border-radius: 4px;
            margin-bottom: 20px;
            font-size: 1.05em;
            line-height: 1.8;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .stat-box {
            background: var(--color-bg);
            padding: 15px;
            border-radius: 6px;
            text-align: center;
        }

        .stat-value {
            font-size: 1.8em;
            font-weight: bold;
            color: var(--color-primary);
        }

        .stat-label {
            color: var(--color-text-secondary);
            font-size: 0.9em;
            margin-top: 5px;
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 1.8em;
            }

            .quiz-container {
                padding: 20px;
            }

            .question {
                font-size: 1.1em;
            }

            button {
                padding: 10px 16px;
                font-size: 0.95em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üìö Examen Traumatolog√≠a</h1>
            <p>Prep√°rate para tu examen con 40 preguntas y 10 casos cl√≠nicos</p>
        </header>

        <div id="mainMenu" class="main-menu">
            <button class="menu-btn" onclick="startQuiz()">üìù Quiz Preguntas (40)</button>
            <button class="menu-btn" onclick="startCases()">üè• Casos Cl√≠nicos (10)</button>
            <button class="menu-btn" onclick="showGuide()">‚ùì C√≥mo Funciona</button>
        </div>

        <div id="guideSection" class="quiz-container hidden">
            <button class="btn-back" onclick="backToMenu()">‚Üê Volver al Men√∫</button>
            <h2 style="margin: 20px 0;">C√≥mo Funciona</h2>
            <div style="line-height: 1.8; font-size: 1.05em;">
                <h3>Quiz Preguntas:</h3>
                <p>‚Ä¢ Responde 40 preguntas de opci√≥n m√∫ltiple del material de traumatolog√≠a</p>
                <p>‚Ä¢ Una sola respuesta correcta por pregunta</p>
                <p>‚Ä¢ Al final ver√°s resultados y respuestas correctas</p>
                <p>‚Ä¢ Descubre d√≥nde necesitas mejorar</p>
                
                <h3 style="margin-top: 20px;">Casos Cl√≠nicos:</h3>
                <p>‚Ä¢ Lee un escenario cl√≠nico realista</p>
                <p>‚Ä¢ Responde 4 preguntas sobre el caso</p>
                <p>‚Ä¢ 10 escenarios diferentes para desarrollar razonamiento cl√≠nico</p>
                <p>‚Ä¢ Casos incluyen fracturas, complicaciones, tratamientos y diagn√≥sticos</p>
            </div>
        </div>

        <div id="quizSection" class="quiz-container hidden">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <button class="btn-back" onclick="backToMenu()">‚Üê Volver al Men√∫</button>
                <span style="font-weight: 600;" id="modeDisplay"></span>
            </div>

            <div class="progress-bar">
                <div class="progress-fill" id="progressFill" style="width: 0%"></div>
            </div>

            <div class="question-number" id="questionNumber"></div>
            <div class="question" id="questionText"></div>
            <div class="options" id="optionsContainer"></div>
            <div class="buttons">
                <button class="btn-primary" id="nextBtn" onclick="nextQuestion()" disabled>Siguiente ‚Üí</button>
                <button class="btn-secondary" id="skipBtn" onclick="skipQuestion()">Saltar esta pregunta</button>
            </div>
        </div>

        <div id="resultsSection" class="results hidden">
            <div class="score-circle" id="scoreDisplay"></div>
            <h2 id="resultTitle"></h2>
            <p id="resultMessage"></p>
            
            <div class="stats">
                <div class="stat-box">
                    <div class="stat-value" id="correctCount"></div>
                    <div class="stat-label">Correctas</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="incorrectCount"></div>
                    <div class="stat-label">Incorrectas</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="skippedCount"></div>
                    <div class="stat-label">Saltadas</div>
                </div>
            </div>

            <div class="detailed-results" id="detailedResults"></div>

            <div class="buttons" style="justify-content: center; margin-top: 30px;">
                <button class="btn-primary" onclick="backToMenu()">‚Üê Volver al Men√∫</button>
                <button class="btn-secondary" onclick="location.reload()">Reiniciar examen</button>
            </div>
        </div>
    </div>

    <script>
        const quizQuestions = [
            {
                id: 1,
                question: "¬øCu√°l es la definici√≥n de fractura seg√∫n traumatolog√≠a?",
                options: ["Lesi√≥n articular", "Soluci√≥n de continuidad de un hueso con origen traum√°tico", "Rotura de un ligamento", "Inflamaci√≥n del hueso"],
                correct: 1
            },
            {
                id: 2,
                question: "¬øCu√°les son los signos cl√≠nicos cl√°sicos de una fractura?",
                options: ["Solo dolor", "Dolor, impotencia funcional, deformidad y tumefacci√≥n", "Solo deformidad", "Inflamaci√≥n sin dolor"],
                correct: 1
            },
            {
                id: 3,
                question: "¬øQu√© es la crepitaci√≥n?",
                options: ["Signo directo de fractura", "Signo indirecto de fractura", "Un s√≠ntoma raro", "No relacionado con fracturas"],
                correct: 1
            },
            {
                id: 4,
                question: "¬øC√≥mo se clasifican las fracturas por tipo de traumatismo?",
                options: ["Solo por localizaci√≥n", "Baja energ√≠a, alta energ√≠a y estr√©s/sobrecarga", "Solo por edad", "Por color de la piel"],
                correct: 1
            },
            {
                id: 5,
                question: "¬øCu√°l es el principio base en el tratamiento de fracturas?",
                options: ["Inmovilizaci√≥n sin reducci√≥n", "Reducci√≥n e inmovilizaci√≥n", "Solo terapia farmacol√≥gica", "Nada es necesario"],
                correct: 1
            },
            {
                id: 6,
                question: "¬øLas fracturas epifisarias/articulares tienen?",
                options: ["El mejor pron√≥stico", "El peor pron√≥stico entre todas", "Pron√≥stico intermedio", "Ninguna consecuencia"],
                correct: 1
            },
            {
                id: 7,
                question: "¬øQu√© es la pseudoartrosis?",
                options: ["Una fractura bien consolidada", "Fracaso de consolidaci√≥n √≥sea", "Una fractura leve", "Un tipo de luxaci√≥n"],
                correct: 1
            },
            {
                id: 8,
                question: "La pseudoartrosis hipertr√≥fica se manifiesta por:",
                options: ["Defecto de vascularizaci√≥n", "Defecto de estabilidad sin d√©ficit vascular", "Siempre infectada", "Sin callo de fractura"],
                correct: 1
            },
            {
                id: 9,
                question: "¬øCu√°les son las fases de consolidaci√≥n √≥sea?",
                options: ["Una sola fase", "Inflamatoria, reparativa y remodelaci√≥n", "Solo formaci√≥n de hueso", "Sin proceso definido"],
                correct: 1
            },
            {
                id: 10,
                question: "La Ley de Wolff describe:",
                options: ["Curaci√≥n de infecciones", "C√≥mo el hueso cambia arquitectura seg√∫n cargas", "Clasificaci√≥n de fracturas", "Nutrici√≥n del hueso"],
                correct: 1
            },
            {
                id: 11,
                question: "Las fracturas abiertas Gustilo IIIC presentan:",
                options: ["Herida < 1 cm", "Herida > 10 cm con lesi√≥n neurovascular", "Solo lesi√≥n muscular", "Herida con infecci√≥n menor"],
                correct: 1
            },
            {
                id: 12,
                question: "Primer paso en manejo de fractura abierta:",
                options: ["Hacer radiograf√≠a", "Gestionar ABCDE del paciente", "Dar antibi√≥ticos", "Suturar inmediatamente"],
                correct: 1
            },
            {
                id: 13,
                question: "Profilaxis antibi√≥tica en fracturas abiertas:",
                options: ["Dosis normales", "Dosis m√°ximas, amplio espectro", "Solo penicilina", "Opcional"],
                correct: 1
            },
            {
                id: 14,
                question: "¬øQu√© complicaci√≥n causa 'contractura isqu√©mica de Volkmann'?",
                options: ["Embolia grasa", "S√≠ndrome compartimental agudo", "Infecci√≥n", "Pseudoartrosis"],
                correct: 1
            },
            {
                id: 15,
                question: "Las '5P' del s√≠ndrome compartimental incluyen:",
                options: ["Dolor, Presi√≥n, Pulsaci√≥n, Par√°lisis, Palidez", "Dolor, Parestesias, Dolor al estiramiento", "Solo dolor y palidez", "No existe tal regla"],
                correct: 0
            },
            {
                id: 16,
                question: "Presi√≥n compartimental > 30-40 mmHg requiere:",
                options: ["Solo observaci√≥n", "Apertura quir√∫rgica (fasciotom√≠a)", "Masaje", "Terapia farmacol√≥gica"],
                correct: 1
            },
            {
                id: 17,
                question: "Algodistrofia o s√≠ndrome de Sudeck:",
                options: ["Dolor proporcional", "Dolor desproporcionado con cambios vegetativos", "Solo inflamaci√≥n", "Sin dolor"],
                correct: 1
            },
            {
                id: 18,
                question: "Fracturas en ni√±os tienen caracter√≠sticas por:",
                options: ["Osteoporosis", "Hueso m√°s el√°stico, periostio grueso, fisis", "Hueso m√°s fr√°gil", "Nada especial"],
                correct: 1
            },
            {
                id: 19,
                question: "Fractura en 'tallo verde' en ni√±os:",
                options: ["Fractura completa", "Fractura incompleta con periostio intacto", "Fractura de f√©mur", "No existe"],
                correct: 1
            },
            {
                id: 20,
                question: "Clasificaci√≥n Salter-Harris tipo I tiene:",
                options: ["Mal pron√≥stico", "Buen pron√≥stico", "Pron√≥stico intermedio", "Pron√≥stico muy malo"],
                correct: 1
            },
            {
                id: 21,
                question: "Fracturas articulares requieren:",
                options: ["Inmovilizaci√≥n gen√©rica", "Reducci√≥n anat√≥mica mediante osteos√≠ntesis interna", "Ning√∫n tratamiento especial", "Solo reposo"],
                correct: 1
            },
            {
                id: 22,
                question: "Las luxaciones se caracterizan por:",
                options: ["Fractura √≥sea", "P√©rdida de contacto articular", "Solo inflamaci√≥n", "Nada espec√≠fico"],
                correct: 1
            },
            {
                id: 23,
                question: "Luxaci√≥n glenohumeral tambi√©n llamada:",
                options: ["Hombro en 'tecla'", "Hombro en 'charretera'", "Hombro normal", "Sin nombre especial"],
                correct: 1
            },
            {
                id: 24,
                question: "Todas las luxaciones necesitan:",
                options: ["Solo observaci√≥n", "Reducci√≥n urgente bajo anestesia e inmovilizaci√≥n", "Solo terapia m√©dica", "Amputaci√≥n"],
                correct: 1
            },
            {
                id: 25,
                question: "Los esguinces son lesiones de:",
                options: ["Hueso", "Ligamentos y c√°psula articular", "M√∫sculos", "Nervios"],
                correct: 1
            },
            {
                id: 26,
                question: "Esguince grado III presenta:",
                options: ["Solo dolor", "Dolor, tumefacci√≥n importante, hemartros, rotura total", "Solo deformidad", "Nada significativo"],
                correct: 1
            },
            {
                id: 27,
                question: "Tratamiento de esguince grado I:",
                options: ["Cirug√≠a inmediata", "Reposo relativo, hielo, vendaje, fisioterapia", "Inmovilizaci√≥n r√≠gida", "Ning√∫n tratamiento"],
                correct: 1
            },
            {
                id: 28,
                question: "Clasificaci√≥n Seddon de lesiones nerviosas:",
                options: ["Dos tipos", "Neuroapraxia, axonotmesis, neurotmesis", "Cuatro tipos", "Sin clasificaci√≥n est√°ndar"],
                correct: 1
            },
            {
                id: 29,
                question: "Neuroapraxia tiene:",
                options: ["Mal pron√≥stico", "Buen pron√≥stico, recuperaci√≥n siempre", "Pron√≥stico variable", "Sin recuperaci√≥n"],
                correct: 1
            },
            {
                id: 30,
                question: "Neurotmesis es:",
                options: ["Interrupci√≥n reversible", "Interrupci√≥n completa, no se recupera sin cirug√≠a", "Compresi√≥n menor", "Lesi√≥n superficial"],
                correct: 1
            },
            {
                id: 31,
                question: "S√≠ndrome compartimental cr√≥nico presenta:",
                options: ["Emergencia m√©dica", "Dolor despu√©s de esfuerzos que mejora con reposo", "Dolor constante", "Sin s√≠ntomas"],
                correct: 1
            },
            {
                id: 32,
                question: "Embolia grasa aparece en:",
                options: ["Todas las fracturas", "Fracturas de huesos grandes, 48-72 horas", "Nunca", "Solo fracturas abiertas"],
                correct: 1
            },
            {
                id: 33,
                question: "TVP se manifiesta con:",
                options: ["Dolor tor√°cico", "Tumefacci√≥n y edema en MMII", "Par√°lisis", "Anestesia"],
                correct: 1
            },
            {
                id: 34,
                question: "Fracturas patol√≥gicas son:",
                options: ["Fracturas en hueso normal", "Fracturas en hueso comprometido (tumoral)", "Fracturas por estr√©s", "Fracturas leves"],
                correct: 1
            },
            {
                id: 35,
                question: "Escala de Mirel > 7-8 puntos en fracturas patol√≥gicas indica:",
                options: ["Tratamiento conservador", "Necesidad de cirug√≠a profil√°ctica", "Sin intervenci√≥n", "Solo observaci√≥n"],
                correct: 1
            },
            {
                id: 36,
                question: "Radiograf√≠as simples son √∫tiles para ver:",
                options: ["Ligamentos y m√∫sculos", "Hueso y lesiones √≥seas", "Solo partes blandas", "Nada en traumatolog√≠a"],
                correct: 1
            },
            {
                id: 37,
                question: "RMN es elecci√≥n para:",
                options: ["Diagn√≥stico √≥seo inicial", "Lesiones partes blandas: ligamentos, meniscos", "Todas las fracturas", "Nada"],
                correct: 1
            },
            {
                id: 38,
                question: "TAC es √∫til en:",
                options: ["Lesiones partes blandas", "Fracturas articulares y estabilidad vertebral", "Ninguna lesi√≥n", "Solo infecciones"],
                correct: 1
            },
            {
                id: 39,
                question: "Reducci√≥n de fractura significa:",
                options: ["Dar medicamentos", "Restaurar estructura anat√≥mica normal", "Inmovilizar paciente", "Hacer radiograf√≠a"],
                correct: 1
            },
            {
                id: 40,
                question: "Osteos√≠ntesis es:",
                options: ["Terapia farmacol√≥gica", "Fijaci√≥n √≥sea con dispositivos", "Tipo de infecci√≥n", "Enfermedad cong√©nita"],
                correct: 1
            }
        ];

        const clinicalCases = [
            {
                id: 1,
                scenario: "Hombre de 72 a√±os con osteoporosis cae del lecho. Dolor intenso en ingle y cadera, no puede levantarse. Extremidad inferior acortada en rotaci√≥n externa. Radiograf√≠a: fractura subcapital cuello femoral.",
                questions: [
                    {text: "¬øMecanismo probable?", options: ["Alta energ√≠a", "Baja energ√≠a con fragilidad", "Fractura patol√≥gica", "Fractura de estr√©s"], correct: 1},
                    {text: "¬øRiesgo vascular principal?", options: ["Hemorragia", "Lesi√≥n femoral", "Necrosis avascular", "Trombosis venosa"], correct: 2},
                    {text: "¬øDiagn√≥stico confirmatorio?", options: ["TAC", "Ecograf√≠a", "Radiograf√≠a", "RMN"], correct: 2},
                    {text: "¬øTratamiento elegido?", options: ["Yeso", "Tracci√≥n", "Osteos√≠ntesis/artroplastia", "Fisioterapia"], correct: 2}
                ]
            },
            {
                id: 2,
                scenario: "Ni√±a 16 a√±os, esguince tobillo en partido f√∫tbol. Tumefacci√≥n lateral importante, equimosis, dificultad caminar pero no impotencia total. Examen neurovascular normal.",
                questions: [
                    {text: "¬øGrado de esguince?", options: ["Grado I", "Grado II", "Grado III", "Sin esguince"], correct: 1},
                    {text: "¬øEstructura da√±ada?", options: ["C√°psula", "Ligamentos laterales", "Tibia", "Nervio"], correct: 1},
                    {text: "¬øPrimer tratamiento?", options: ["Yeso 6 semanas", "Reposo, hielo, vendaje, fisioterapia", "Cirug√≠a", "Solo analg√©sicos"], correct: 1},
                    {text: "¬øTiempo inmovilizaci√≥n?", options: ["1 d√≠a", "1 semana", "3 semanas", "3 meses"], correct: 2}
                ]
            },
            {
                id: 3,
                scenario: "Hombre 45 a√±os, accidente vehicular alta energ√≠a. Fractura expuesta tercio medio f√©mur, herida 30 cm contaminada, periostio da√±ado, signos de shock. Edema masivo en pierna.",
                questions: [
                    {text: "¬øGrado Gustilo?", options: ["I", "II", "IIIB", "IIIC"], correct: 2},
                    {text: "¬øPrimer paso?", options: ["Suturar herida", "ABCDE y estabilizaci√≥n", "Radiograf√≠a", "Analgesia"], correct: 1},
                    {text: "¬øProcedimiento indicado?", options: ["Yeso", "Fijador externo", "Vendaje", "Tracci√≥n"], correct: 1},
                    {text: "¬øProfilaxis antibi√≥tica?", options: ["Cefalosporina sola", "Cefalosporina + aminogluc√≥sidos + penicilina", "No necesaria", "Solo tetraciclina"], correct: 1}
                ]
            },
            {
                id: 4,
                scenario: "Ni√±o 10 a√±os, cae bicicleta apoyando mano extendida. Dolor tumefacci√≥n mu√±eca, impotencia funcional. Radiograf√≠a: fractura radio distal con angulaci√≥n dorsal, 'dorso de tenedor'.",
                questions: [
                    {text: "¬øNombre fractura?", options: ["Monteggia", "Colles", "Galeazzi", "Smith"], correct: 1},
                    {text: "¬øMecanismo lesi√≥n?", options: ["Rotaci√≥n", "Ca√≠da mano extendida", "Compresi√≥n axial", "Estiramiento"], correct: 1},
                    {text: "¬øComplicaci√≥n frecuente?", options: ["Infecci√≥n", "Algodistrofia", "Siempre bien", "Nada"], correct: 1},
                    {text: "¬øTratamiento inicial?", options: ["Cirug√≠a", "Reducci√≥n e inmovilizaci√≥n", "Fisioterapia", "Extirpaci√≥n"], correct: 1}
                ]
            },
            {
                id: 5,
                scenario: "Hombre 55 a√±os, despu√©s reducci√≥n fractura f√©mur con yeso apretado. A las 6 horas: dolor intenso, parestesias, m√∫sculo p√°lido. S√≠ntomas no alivian aunque levanten yeso.",
                questions: [
                    {text: "¬øComplicaci√≥n?", options: ["Infecci√≥n", "S√≠ndrome compartimental", "Embolia grasa", "Pseudoartrosis"], correct: 1},
                    {text: "¬øPresi√≥n compartimental cr√≠tica?", options: ["< 10", "> 30-40", "< 5", "Sin l√≠mite"], correct: 1},
                    {text: "¬øTratamiento urgencia?", options: ["Antibi√≥ticos", "Fasciotom√≠a", "Masaje", "Manual"], correct: 1},
                    {text: "¬øSecuela grave?", options: ["Dolor cr√≥nico", "Contractura Volkmann", "Solo artrosis", "Nada"], correct: 1}
                ]
            },
            {
                id: 6,
                scenario: "Mujer 35 a√±os, c√°ncer mama metast√°sico. Fractura patol√≥gica cuello f√©mur, baja energ√≠a (ca√≠da cama). Radiograf√≠a: lesi√≥n con bordes mal delimitados.",
                questions: [
                    {text: "¬øTipo fractura?", options: ["Estr√©s", "Patol√≥gica", "Fragilidad", "Traum√°tica normal"], correct: 1},
                    {text: "¬øObjetivo tratamiento?", options: ["Curaci√≥n completa", "Calidad de vida y funci√≥n", "Prevenci√≥n", "Amputaci√≥n"], correct: 1},
                    {text: "¬øTratamiento apropiado?", options: ["Conservador", "Osteos√≠ntesis simple", "Nada", "Quimioterapia"], correct: 1},
                    {text: "¬øEscala Mirel para?", options: ["Gravedad met√°stasis", "Cirug√≠a profil√°ctica", "Funci√≥n motora", "Supervivencia"], correct: 1}
                ]
            },
            {
                id: 7,
                scenario: "Joven 20 a√±os, distorsi√≥n importante rodilla en f√∫tbol. Dolor agudo, deformidad, hemartros, dificultad movilidad. TAC: luxaci√≥n tibiofemoral.",
                questions: [
                    {text: "¬øComplicaci√≥n grave?", options: ["Menisco", "Neurovascular", "Ligamento", "Nada"], correct: 1},
                    {text: "¬øNervio en riesgo?", options: ["Radial", "Ci√°tico popl√≠teo externo", "Mediano", "Safeno"], correct: 1},
                    {text: "¬øArteria lesionada?", options: ["Observar", "Reparaci√≥n vascular", "Anticoagulantes", "Amputaci√≥n"], correct: 1},
                    {text: "¬øPrimer paso?", options: ["Imaging", "Reducci√≥n urgencia", "Cirug√≠a planificada", "Medicinas"], correct: 1}
                ]
            },
            {
                id: 8,
                scenario: "Ni√±a 8 a√±os, cae jugando. Fractura codo. Tumefacci√≥n masiva, dolor, imposibilidad movimiento. Radiograf√≠a: fractura condiloide h√∫mero desplazada.",
                questions: [
                    {text: "¬øRiesgo principal?", options: ["Dolor", "Neurovascular y compartimental", "Infecci√≥n", "Nada"], correct: 1},
                    {text: "¬øA preservar?", options: ["Ol√©cranon", "Fisis y cart√≠lago crecimiento", "Cortical", "Periostio"], correct: 1},
                    {text: "¬øTratamiento?", options: ["Yeso", "Reducci√≥n precisa e osteos√≠ntesis", "Tracci√≥n", "Extirpaci√≥n"], correct: 1},
                    {text: "¬øComplicaci√≥n tard√≠a?", options: ["Infecci√≥n", "Alteraci√≥n crecimiento", "Pseudoartrosis", "Nada"], correct: 1}
                ]
            },
            {
                id: 9,
                scenario: "Paciente 65 a√±os, fractura vertebral cervical C5 por colisi√≥n posterior. Tetraplegia (4 extremidades), alteraci√≥n sensibilidad. RMN: compresi√≥n m√©dula espinal.",
                questions: [
                    {text: "¬øPrimer paso?", options: ["Inmovilizaci√≥n cuello y ABCDE", "Cirug√≠a urgencia", "Esteroides", "Rehabilitaci√≥n"], correct: 0},
                    {text: "¬øCausa tetraplegia?", options: ["Ansiedad", "Compresi√≥n m√©dula", "Rad√≠cula", "Nada"], correct: 1},
                    {text: "¬øTratamiento?", options: ["Collar√≠n", "Tracci√≥n y osteos√≠ntesis", "Nada", "Amputaci√≥n"], correct: 1},
                    {text: "¬øPron√≥stico neurol√≥gico?", options: ["Siempre bien", "Depende lesi√≥n y descompresi√≥n", "Siempre mal", "Independiente"], correct: 1}
                ]
            },
            {
                id: 10,
                scenario: "Var√≥n 30 a√±os, luxaci√≥n hombro derecho al levantar peso. Dolor severo, deformidad t√≠pica, imposibilidad movimiento. Ausencia pulsaciones distales pero mano caliente.",
                questions: [
                    {text: "¬øTipo luxaci√≥n frecuente?", options: ["Anterior", "Posterior", "Inferior", "Superior"], correct: 0},
                    {text: "¬øNervio a evaluar?", options: ["Mediano", "Radial", "Axilar", "Cubital"], correct: 2},
                    {text: "¬øPrimer tratamiento?", options: ["Radiograf√≠a", "Reducci√≥n urgencia", "Cirug√≠a", "Medicinas"], correct: 1},
                    {text: "¬øComplicaci√≥n a monitorear?", options: ["Infecci√≥n", "Lesi√≥n vascular isquemia", "Artritis", "Rigidez"], correct: 1}
                ]
            }
        ];

        let currentQuestion = 0;
        let currentCase = 0;
        let mode = null;
        let answers = [];
        let caseAnswers = [];

        function startQuiz() {
            mode = 'quiz';
            currentQuestion = 0;
            answers = new Array(quizQuestions.length).fill(null);
            showQuestion();
        }

        function startCases() {
            mode = 'cases';
            currentCase = 0;
            caseAnswers = [];
            showCaseQuestion();
        }

        function showGuide() {
            document.getElementById('mainMenu').classList.add('hidden');
            document.getElementById('quizSection').classList.add('hidden');
            document.getElementById('resultsSection').classList.add('hidden');
            document.getElementById('guideSection').classList.remove('hidden');
        }

        function showQuestion() {
            document.getElementById('mainMenu').classList.add('hidden');
            document.getElementById('quizSection').classList.remove('hidden');
            document.getElementById('guideSection').classList.add('hidden');
            document.getElementById('resultsSection').classList.add('hidden');

            const question = quizQuestions[currentQuestion];
            const progress = ((currentQuestion + 1) / quizQuestions.length) * 100;

            document.getElementById('progressFill').style.width = progress + '%';
            document.getElementById('questionNumber').textContent = `Pregunta ${currentQuestion + 1} de ${quizQuestions.length}`;
            document.getElementById('modeDisplay').textContent = 'Quiz - Preguntas de opci√≥n m√∫ltiple';
            document.getElementById('questionText').textContent = question.question;
            document.getElementById('nextBtn').disabled = true;

            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';

            question.options.forEach((option, index) => {
                const label = document.createElement('label');
                label.className = 'option';
                label.innerHTML = `<input type="radio" name="answer" value="${index}"> ${option}`;
                label.onclick = () => {
                    answers[currentQuestion] = index;
                    document.getElementById('nextBtn').disabled = false;
                };
                optionsContainer.appendChild(label);
            });
        }

        function showCaseQuestion() {
            document.getElementById('mainMenu').classList.add('hidden');
            document.getElementById('quizSection').classList.remove('hidden');
            document.getElementById('guideSection').classList.add('hidden');
            document.getElementById('resultsSection').classList.add('hidden');

            const caseData = clinicalCases[currentCase];
            const questionIndex = caseAnswers.length;
            const caseQuestion = caseData.questions[questionIndex];

            document.getElementById('modeDisplay').textContent = `Caso Cl√≠nico ${currentCase + 1} de ${clinicalCases.length}`;

            if (questionIndex === 0) {
                document.getElementById('questionNumber').innerHTML = `<div class="case-scenario">${caseData.scenario}</div>`;
            } else {
                document.getElementById('questionNumber').innerHTML = '';
            }

            const progress = ((currentCase * 4 + questionIndex + 1) / (clinicalCases.length * 4)) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
            document.getElementById('questionText').textContent = caseQuestion.text;
            document.getElementById('nextBtn').disabled = true;

            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';

            caseQuestion.options.forEach((option, index) => {
                const label = document.createElement('label');
                label.className = 'option';
                label.innerHTML = `<input type="radio" name="answer" value="${index}"> ${option}`;
                label.onclick = () => {
                    document.getElementById('nextBtn').disabled = false;
                    caseAnswers.push(index);
                };
                optionsContainer.appendChild(label);
            });
        }

        function nextQuestion() {
            if (mode === 'quiz') {
                if (currentQuestion < quizQuestions.length - 1) {
                    currentQuestion++;
                    showQuestion();
                } else {
                    showQuizResults();
                }
            } else if (mode === 'cases') {
                const caseData = clinicalCases[currentCase];
                if (caseAnswers.length < caseData.questions.length) {
                    showCaseQuestion();
                } else if (currentCase < clinicalCases.length - 1) {
                    currentCase++;
                    caseAnswers = [];
                    showCaseQuestion();
                } else {
                    showCasesResults();
                }
            }
        }

        function skipQuestion() {
            if (mode === 'quiz') {
                answers[currentQuestion] = null;
                if (currentQuestion < quizQuestions.length - 1) {
                    currentQuestion++;
                    showQuestion();
                } else {
                    showQuizResults();
                }
            }
        }

        function showQuizResults() {
            document.getElementById('quizSection').classList.add('hidden');
            document.getElementById('resultsSection').classList.remove('hidden');

            let correct = 0;
            let incorrect = 0;
            let skipped = 0;

            quizQuestions.forEach((q, i) => {
                if (answers[i] === null) skipped++;
                else if (answers[i] === q.correct) correct++;
                else incorrect++;
            });

            const percentage = Math.round((correct / quizQuestions.length) * 100);
            document.getElementById('scoreDisplay').textContent = percentage + '%';
            document.getElementById('correctCount').textContent = correct;
            document.getElementById('incorrectCount').textContent = incorrect;
            document.getElementById('skippedCount').textContent = skipped;

            if (percentage >= 70) {
                document.getElementById('resultTitle').textContent = '¬°Excelente! üéâ';
                document.getElementById('resultMessage').textContent = `Obtuviste ${percentage}% - ¬°Est√°s bien preparado para el examen!`;
            } else if (percentage >= 50) {
                document.getElementById('resultTitle').textContent = '¬°Bien! üëç';
                document.getElementById('resultMessage').textContent = `Obtuviste ${percentage}% - Contin√∫a estudiando las √°reas d√©biles.`;
            } else {
                document.getElementById('resultTitle').textContent = 'Sigue estudiando üìö';
                document.getElementById('resultMessage').textContent = `Obtuviste ${percentage}% - Revisa el material y vuelve a intentar.`;
            }

            const detailedResults = document.getElementById('detailedResults');
            detailedResults.innerHTML = '<h3>Revisi√≥n de respuestas:</h3>';

            quizQuestions.forEach((q, i) => {
                const resultItem = document.createElement('div');
                resultItem.className = 'result-item';

                if (answers[i] === null) {
                    resultItem.classList.add('incorrect');
                    resultItem.innerHTML = `
                        <div class="result-question">‚ùì Pregunta ${i + 1}: ${q.question}</div>
                        <div class="result-answer"><strong>Saltada</strong></div>
                        <div class="result-answer"><strong>Respuesta correcta:</strong> ${q.options[q.correct]}</div>
                    `;
                } else if (answers[i] === q.correct) {
                    resultItem.classList.add('correct');
                    resultItem.innerHTML = `
                        <div class="result-question">‚úì Pregunta ${i + 1}: ${q.question}</div>
                        <div class="result-answer"><strong>Tu respuesta:</strong> ${q.options[answers[i]]}</div>
                    `;
                } else {
                    resultItem.classList.add('incorrect');
                    resultItem.innerHTML = `
                        <div class="result-question">‚úó Pregunta ${i + 1}: ${q.question}</div>
                        <div class="result-answer"><strong>Tu respuesta:</strong> ${q.options[answers[i]]}</div>
                        <div class="result-answer"><strong>Respuesta correcta:</strong> ${q.options[q.correct]}</div>
                    `;
                }
                detailedResults.appendChild(resultItem);
            });
        }

        function showCasesResults() {
            document.getElementById('quizSection').classList.add('hidden');
            document.getElementById('resultsSection').classList.remove('hidden');

            let correct = 0;
            let total = 0;

            clinicalCases.forEach((caseItem, caseIdx) => {
                caseItem.questions.forEach((q, qIdx) => {
                    if (caseAnswers[caseIdx * 4 + qIdx] === q.correct) correct++;
                    total++;
                });
            });

            const percentage = Math.round((correct / total) * 100);
            document.getElementById('scoreDisplay').textContent = percentage + '%';
            document.getElementById('correctCount').textContent = correct;
            document.getElementById('incorrectCount').textContent = total - correct;
            document.getElementById('skippedCount').textContent = '0';

            if (percentage >= 70) {
                document.getElementById('resultTitle').textContent = '¬°Razonamiento cl√≠nico excelente! üéØ';
                document.getElementById('resultMessage').textContent = `Obtuviste ${percentage}% - ¬°Aplicas bien la teor√≠a!`;
            } else {
                document.getElementById('resultTitle').textContent = 'Contin√∫a practicando üìö';
                document.getElementById('resultMessage').textContent = `Obtuviste ${percentage}% - Repasa los casos cl√≠nicos.`;
            }

            const detailedResults = document.getElementById('detailedResults');
            detailedResults.innerHTML = '<h3>Revisi√≥n de Casos Cl√≠nicos:</h3>';

            clinicalCases.forEach((caseItem, caseIdx) => {
                const caseSection = document.createElement('div');
                caseSection.innerHTML = `<div style="font-weight: bold; margin-top: 15px; color: var(--color-primary);">Caso ${caseIdx + 1}:</div>`;
                
                caseItem.questions.forEach((q, qIdx) => {
                    const answerIdx = caseIdx * 4 + qIdx;
                    const resultItem = document.createElement('div');
                    resultItem.className = 'result-item';

                    if (caseAnswers[answerIdx] === q.correct) {
                        resultItem.classList.add('correct');
                        resultItem.innerHTML = `<div class="result-question">‚úì Pregunta ${qIdx + 1}: ${q.text}</div>`;
                    } else {
                        resultItem.classList.add('incorrect');
                        resultItem.innerHTML = `
                            <div class="result-question">‚úó Pregunta ${qIdx + 1}: ${q.text}</div>
                            <div class="result-answer"><strong>Tu respuesta:</strong> ${caseAnswers[answerIdx] !== undefined ? q.options[caseAnswers[answerIdx]] : 'No respondida'}</div>
                            <div class="result-answer"><strong>Respuesta correcta:</strong> ${q.options[q.correct]}</div>
                        `;
                    }
                    caseSection.appendChild(resultItem);
                });
                detailedResults.appendChild(caseSection);
            });
        }

        function backToMenu() {
            currentQuestion = 0;
            currentCase = 0;
            mode = null;
            answers = [];
            caseAnswers = [];

            document.getElementById('mainMenu').classList.remove('hidden');
            document.getElementById('quizSection').classList.add('hidden');
            document.getElementById('guideSection').classList.add('hidden');
            document.getElementById('resultsSection').classList.add('hidden');
        }
    </script>
</body>
</html>